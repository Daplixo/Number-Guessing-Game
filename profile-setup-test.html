<!DOCTYPE html>
<html lang="en" data-theme="dark">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
    />
    <title>Profile Setup Test</title>

    <!-- Styles -->
    <link rel="stylesheet" href="css/styles.min.css" />
    <link rel="stylesheet" href="css/modal-fix.css" />

    <style>
      /* Additional test-specific styling */
      body {
        display: flex;
        justify-content: center;
        align-items: center;
        min-height: 100vh;
        padding: 20px;
      }

      .test-controls {
        position: fixed;
        bottom: 20px;
        left: 0;
        right: 0;
        display: flex;
        justify-content: center;
        gap: 10px;
        padding: 10px;
        background: var(--card-bg);
        border-top: 1px solid var(--border-color);
        z-index: 100;
      }

      .test-controls button {
        padding: 8px 16px;
        background: var(--btn-primary);
        color: white;
        border: none;
        border-radius: 4px;
        cursor: pointer;
      }

      /* Force modal to show by default for testing */
      #profileSetupModal {
        display: flex !important;
        opacity: 1 !important;
        visibility: visible !important;
        pointer-events: auto !important;
      }
    </style>
  </head>

  <body>
    <!-- Profile Setup Modal for Testing -->
    <div id="profileSetupModal" class="modal-wrapper active">
      <div class="modal-content profile-setup">
        <h2>Welcome to Number Guessing Game!</h2>
        <p>Please set up your profile to continue.</p>
        <form id="profileSetupForm">
          <div class="form-group">
            <label for="profileName">Your Name</label>
            <input
              type="text"
              id="profileName"
              name="name"
              required
              minlength="2"
              placeholder="Enter your name"
            />
          </div>
          <div class="form-group">
            <label for="profileAge">Your Age</label>
            <input
              type="number"
              id="profileAge"
              name="age"
              required
              min="1"
              max="120"
              placeholder="Enter your age"
            />
          </div>
          <div class="form-group">
            <label for="profilePicture">Profile Picture (Optional)</label>
            <input
              type="file"
              id="profilePicture"
              name="picture"
              accept="image/*"
            />
            <div id="picturePreview" class="picture-preview"></div>
          </div>
          <button type="submit" class="submit-btn">Save Profile</button>
        </form>
      </div>
    </div>

    <!-- Test Controls -->
    <div class="test-controls">
      <button id="toggleThemeBtn">Toggle Theme</button>
      <button id="resetFormBtn">Reset Form</button>
    </div>

    <!-- Testing Scripts -->
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        // Handle profile picture upload preview
        const profilePicture = document.getElementById("profilePicture");
        const picturePreview = document.getElementById("picturePreview");

        if (profilePicture && picturePreview) {
          profilePicture.addEventListener("change", function (event) {
            const file = event.target.files[0];
            if (file) {
              if (file.size > 5242880) {
                // 5MB max
                alert(
                  "Image file is too large. Please choose an image under 5MB."
                );
                return;
              }

              const reader = new FileReader();
              reader.onload = function (e) {
                picturePreview.style.backgroundImage = `url(${e.target.result})`;
                picturePreview.dataset.image = e.target.result;
              };
              reader.readAsDataURL(file);
            }
          });
        }

        // Theme toggle
        const toggleThemeBtn = document.getElementById("toggleThemeBtn");
        if (toggleThemeBtn) {
          toggleThemeBtn.addEventListener("click", function () {
            const html = document.documentElement;
            const currentTheme = html.getAttribute("data-theme");
            const newTheme = currentTheme === "dark" ? "light" : "dark";
            html.setAttribute("data-theme", newTheme);
          });
        }

        // Form reset
        const resetFormBtn = document.getElementById("resetFormBtn");
        const profileSetupForm = document.getElementById("profileSetupForm");
        if (resetFormBtn && profileSetupForm) {
          resetFormBtn.addEventListener("click", function () {
            profileSetupForm.reset();
            picturePreview.style.backgroundImage = "";
            picturePreview.dataset.image = "";
          });
        }

        // Prevent actual form submission
        profileSetupForm.addEventListener("submit", function (e) {
          e.preventDefault();
          const formData = new FormData(this);
          console.log("Form data:", Object.fromEntries(formData));
          alert(
            "Profile would be saved with: " +
              formData.get("name") +
              ", Age: " +
              formData.get("age")
          );
        });
      });
    </script>
  </body>
</html>
